
<%@page import="com.google.gson.Gson"%>
<%@page import="kr.or.ddit.dam.vo.MemVO"%>
<%@page import="kr.or.ddit.dam.mem.service.MemServiceImpl"%>
<%@page import="kr.or.ddit.dam.mem.service.IMemService"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>BookDam</title>
   <link rel="shortcut icon" href="${pageContext.request.contextPath}/images/favicon.png" type="image/png" />
   <script src="${pageContext.request.contextPath}/js/jquery-3.7.1.js"></script>
   <script src="${pageContext.request.contextPath}/js/jquery.serializejson.min.js"></script>
   <script src="${pageContext.request.contextPath}/js/bookSearch.js"></script>
<%--    <li><a href="<%=request.getContextPath()%>/BestBook.do"></a></li> --%>
<%--    <ul class="no-dot">	
	<li><a href="<%=request.getContextPath()%>/BestBook.do"></a></li>
    <li><a href="<%=request.getContextPath()%>/BookDetail.do"></a></li>
   </ul> --%>
   <link rel="stylesheet" type="text/css" href="<%= request.getContextPath()%>/css/bookSearchCss.css">
   <link rel="stylesheet" href="${pageContext.request.contextPath}/main/main.css" />
   <link rel="stylesheet" href="${pageContext.request.contextPath}/css/mainBannerCss.css"/>
	
  <script>

  currentPage = 1;
  memMail = null;

  //////////////////ë‹¤ë¥¸ í˜ì´ì§€ì—ë„ í•„ìˆ˜ë¡œ ë„£ì–´ì•¼ í•˜ëŠ” ì´ë²¤íŠ¸ //////////////////
<%
	// ì„¸ì…˜ì—ì„œ loginOk ê°’ì„ ê°€ì ¸ì™€ ë¡œê·¸ì¸ ì—¬ë¶€ í™•ì¸
	MemVO mvo = (MemVO) session.getAttribute("loginOk");
	
	String user = null;
	Gson gson = new Gson();
	// ë§Œì•½ loginOk ê°’ì´ ìˆë‹¤ë©´ mvo ê°ì²´ë¥¼ userì— ëŒ€ì…
	if (mvo != null) user = gson.toJson(mvo);
%>

  // BookDam (í”„ë¡œì íŠ¸ ì´ë¦„)
  mypath = '<%= request.getContextPath()%>';  
  // ë¡œê·¸ì¸ ìœ ì € ê°ì²´
  logUser = <%= user == null ? "null" : user %>;

  // ë¡œê·¸ì¸ í™•ì¸ìš© ì½˜ì†”ì°½
  if(logUser != null) {
	  console.log("í˜„ì¬ ë¡œê·¸ì¸ID :" + logUser.mem_mail);
	  memMail = logUser.mem_mail;
  } else {
	  console.log("ë¡œê·¸ì¸ ìƒíƒœ : ë¹„íšŒì›");
	  memMail = null;
  }

  // ë¡œê·¸ì•„ì›ƒ í´ë¦­ì‹œ...
  const logout = async () =>{
		try{
			response = await fetch('/BookDam/Logout.do');
			if(!response.ok){
				throw new Error('ì„œë²„ì˜¤ë¥˜:' + response.status);
			}
			result = await response.json();
			
			if(result&& result.flag === 'ok') {
				alert("ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.");
				sessionStorage.removeItem('cartArr');
				window.location.href = `\${mypath}/BestBook.do`;
			} else {
				alert("ë¡œê·¸ì•„ì›ƒ ì‹¤íŒ¨");
			}
		}catch(error){
			console.error("ë¡œê·¸ì•„ì›ƒ ìš”ì²­ ì‹¤íŒ¨ : " , error);
			alert("ì˜¤ë¥˜ë°œìƒ")
		}
  }

	// ë§ˆì´í˜ì´ì§€ í´ë¦­ì‹œ... (íšŒì› & ë¹„íšŒì›)
	const goMypage = () => {
		if (logUser != null) {
			location.href= `<%=request.getContextPath()%>/myPage/mypage.jsp`
		} else {
			location.href= `<%=request.getContextPath()%>/log/login.jsp`;	
		}
	}

////////////////////////////////////////////////////////////////////
	// ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ ì˜ì—­ ì¶”ê°€í•¨
 	function openCategoryMenu() {
        document.getElementById('categoryOverlay').classList.add('active');
        document.body.style.overflow = 'hidden'; // ìŠ¤í¬ë¡¤ ë°©ì§€
    }

    function closeCategoryMenu() {
        document.getElementById('categoryOverlay').classList.remove('active');
        document.body.style.overflow = 'auto'; // ìŠ¤í¬ë¡¤ ë³µì›
    }
    
    function goToBookList(category) {
    	console.log('í´ë¦­í•œ ì¹´í…Œê³ ë¦¬:', category);
    	console.log('ì¸ì½”ë”©ëœ ì¹´í…Œê³ ë¦¬:', encodeURIComponent(category)); 
    	/* alert("ì„ íƒëœ ì¹´í…Œê³ ë¦¬:"+ category); */
        closeCategoryMenu();
        
        window.location.href = '<%=request.getContextPath()%>/bookSearch/bookCategoryList.jsp?category=' + encodeURIComponent(category);
    }
//////////////////////////////////////////////////////////////////
 
    // ===== ìŠ¬ë¼ì´ë”  =====
	let newCurrentSlide = 0; // í˜„ì¬ ìŠ¬ë¼ì´ë“œ
	const newTotalSlides = 5; // ìŠ¬ë¼ì´ë“œ ìˆ˜ (0, 1, 2, 3, 4)
	let newAutoSlideInterval = null;
	
	// ìŠ¬ë¼ì´ë“œ ì´ë™ í•¨ìˆ˜
	function newMoveToSlide(slideIndex) {
		console.log("ìƒˆ ìŠ¬ë¼ì´ë” ì´ë™:", slideIndex);
	    
	    const wrapper = document.getElementById('newSliderWrapper');
	    if (!wrapper) {
	        console.log("wrapper ìš”ì†Œ ì—†ìŒ!");
	        return;
	    }
	    
	    const movePercent = -slideIndex * 20; // 20% = 100% / 5ê°œ
	    console.log("ê³„ì‚°ëœ movePercent:", movePercent);
	    
	    wrapper.style.transform = "translateX(" + movePercent + "%)";
	    console.log("ì ìš©ëœ transform:", wrapper.style.transform)
	    
	    // ì¸ë””ì¼€ì´í„° ì—…ë°ì´íŠ¸
	    document.querySelectorAll('.new-indicator').forEach((dot, index) => {
	        dot.classList.toggle('active', index === slideIndex);
	    });
	    
	    newCurrentSlide = slideIndex;
	    console.log(`ìŠ¬ë¼ì´ë“œ ${slideIndex}ë¡œ ì´ë™ ì™„ë£Œ: ${movePercent}%`);
	}
	
	// ìŠ¬ë¼ì´ë“œ ë³€ê²½ - ì½˜ì†” ë©”ì„¸ì§€ ì˜ ë³´ê¸°.....
	function newChangeSlide(direction) {
		console.log("ìŠ¬ë¼ì´ë“œ ë³€ê²½ ì‹œì‘ - direction:", direction, "í˜„ì¬:", newCurrentSlide); // ì½˜ì†”ì— ì°íˆëŠ” ê±° í™•ì¸í•˜ê¸°!!!!!!!!
	    
	    newCurrentSlide += direction;
	    console.log("ìŠ¬ë¼ì´ë“œ ë³€ê²½ ì‹œì‘ - direction:", direction, "í˜„ì¬:", newCurrentSlide); // ì½˜ì†”ì— ì°íˆëŠ” ê±° í™•ì¸í•˜ê¸°!!!!!!!! ì—¬ê¸°ë‘...
	    
	    if (newCurrentSlide >= newTotalSlides) { // í˜„ì¬ ìŠ¬ë¼ì´ë“œ >= ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œ -> í˜„ì¬ ìŠ¬ë¼ì´ë“œë¥¼ 1ë²ˆì§¸ ìŠ¬ë¼ì´ë“œë¡œ(ë§ˆì§€ë§‰ ìŠ¬ë¼ì´ë“œë©´ 1ë²ˆì§¸ ìŠ¬ë¼ì´ë“œë¡œ ê°„ë‹¤)
	        newCurrentSlide = 0;
	        console.log("ë§ˆì§€ë§‰ì—ì„œ ì²˜ìŒìœ¼ë¡œ:", newCurrentSlide);
	    } else if (newCurrentSlide < 0) {		
	        newCurrentSlide = newTotalSlides - 1;
	        console.log("ì²˜ìŒì—ì„œ ë§ˆì§€ë§‰ìœ¼ë¡œ:", newCurrentSlide);
	    }
	    console.log("ìµœì¢… ì´ë™í•  ìŠ¬ë¼ì´ë“œ:", newCurrentSlide);
	    newMoveToSlide(newCurrentSlide);
	    newResetAutoSlide();
	}
	
	// íŠ¹ì • ìŠ¬ë¼ì´ë“œë¡œ ì´ë™
	function newGoToSlide(slideIndex) {
	    console.log("íŠ¹ì • ìŠ¬ë¼ì´ë“œë¡œ ì´ë™:", slideIndex);
	    newCurrentSlide = slideIndex;
	    newMoveToSlide(slideIndex);
	    newResetAutoSlide();
	}
	
	// ìë™ ìŠ¬ë¼ì´ë“œ ì‹œì‘
	function newStartAutoSlide() {
	    console.log("ìë™ ìŠ¬ë¼ì´ë“œ ì‹œì‘");
	    if (newAutoSlideInterval) clearInterval(newAutoSlideInterval);
	    
	    newAutoSlideInterval = setInterval(() => {
	        console.log("ìë™ ìŠ¬ë¼ì´ë“œ ì‹¤í–‰");
	        newChangeSlide(1);
	    }, 3500);
	}
	
	// ìë™ ìŠ¬ë¼ì´ë“œ ì¤‘ì§€ - ë§ˆìš°ìŠ¤ ì˜¬ë ¤ë†“ì„ ë•Œ ë©ˆì¶”ê²Œ í•˜ë ¤ê³ !
	function newStopAutoSlide() {
	    if (newAutoSlideInterval) {
	        clearInterval(newAutoSlideInterval);
	        newAutoSlideInterval = null;
	        console.log("ìë™ ìŠ¬ë¼ì´ë“œ ì¤‘ì§€");
	    }
	}
	
	// ìë™ ìŠ¬ë¼ì´ë“œ ë¦¬ì…‹
	function newResetAutoSlide() {
	    newStopAutoSlide();
	    newStartAutoSlide();
	}
	
	//ìŠ¬ë¼ì´ë” ì´ˆê¸°í™” í•¨ìˆ˜
	function initializeSlider() {
	    console.log("ìŠ¬ë¼ì´ë” ì´ˆê¸°í™” ì‹œì‘");
	    
	    // ì²« ë²ˆì§¸ ìŠ¬ë¼ì´ë“œë¡œ ì„¤ì •
	    newMoveToSlide(0);
	    
	    // ì´ì „/ë‹¤ìŒ ë²„íŠ¼ ì´ë²¤íŠ¸
	    $('.new-prev-btn').off('click').on('click', function() {
	        console.log("ì´ì „ ë²„íŠ¼ í´ë¦­");
	        newChangeSlide(-1); // ì´ì „ ë²„íŠ¼: ìŠ¬ë¼ì´ë” -1 -> ì´ì „ ìŠ¬ë¼ì´ë”ë¡œ ê°
	    });
	    
	    $('.new-next-btn').off('click').on('click', function() {
	        console.log("ë‹¤ìŒ ë²„íŠ¼ í´ë¦­");
	        newChangeSlide(1); // ë‹¤ìŒ ë²„íŠ¼: ìŠ¬ë¼ì´ë” +1 -> ë‹¤ìŒ ìŠ¬ë¼ì´ë”ë¡œ ê°
	    });
	    
	    // ì¸ë””ì¼€ì´í„° ì´ë²¤íŠ¸ - ë°‘ì— ë™ê·¸ë¼ë¯¸ë“¤
	    $('.new-indicator').off('click').on('click', function() {
	        const slideIndex = parseInt($(this).attr('data-slide'));
	        console.log("ì¸ë””ì¼€ì´í„° í´ë¦­:", slideIndex);
	        newGoToSlide(slideIndex);
	    });
	    
	    // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
	    const container = document.querySelector('.new-slider-container');
	    if (container) {
	        container.addEventListener('mouseenter', newStopAutoSlide);
	        container.addEventListener('mouseleave', newStartAutoSlide);
	        console.log("ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸ ë“±ë¡ë¨");
	    }
	    
	    // ìŠ¬ë¼ì´ë“œ í´ë¦­ ì´ë²¤íŠ¸
	    $('.new-slide').off('click').on('click', function() {
	        const link = $(this).data('link');
	        console.log("ìŠ¬ë¼ì´ë“œ í´ë¦­:", link);
	        
	        // ============ì—¬ê¸°ëŠ” ì„ì‹œ í…ŒìŠ¤íŠ¸ ifê³  ì±„íŒ… ì™„ì„±í•˜ë©´ ë°”ê¿”ì•¼ í•©ë‹ˆë‹¤================!!!!!!!
	        if (link === '#category') {
	            if (typeof openCategoryMenu === 'function') {
	                openCategoryMenu();
	            }
	        } else if (link && link !== '#') {
	            window.location.href = link;
	        }
	        //==========================================================================
	    });
	    
	    // í‚¤ë³´ë“œ ì´ë²¤íŠ¸
	    $(document).off('keydown.slider').on('keydown.slider', function(e) {
	        if (e.key === 'ArrowLeft') {
	            newChangeSlide(-1);
	        } else if (e.key === 'ArrowRight') {
	            newChangeSlide(1);
	        }
	    });
	    
	    // ìë™ ìŠ¬ë¼ì´ë“œ ì‹œì‘
	    setTimeout(() => {
	        newStartAutoSlide();
	        console.log("ìë™ ìŠ¬ë¼ì´ë“œ ì‹œì‘!");
	    }, 1000);
	    
	    console.log("ìŠ¬ë¼ì´ë” ì´ˆê¸°í™” ì™„ë£Œ");
	}
//-------------ìŠ¬ë¼ì´ë” ë-----------

// ì±„íŒ… ë°°ë„ˆ í´ë¦­ ì´ë²¤íŠ¸
function connectWebSocket() {
 	const width = 1400
	const height = 900

	const left = (window.screen.width - width) / 2;
	const top = (window.screen.height - height) / 2;

	window.open(
	   `\${mypath}/ext/webSocketMutiChatting.jsp`, // ì±„íŒ… ì „ìš© í˜ì´ì§€
	   "chatPopup",
	   `width=\${width},height=\${height},left=\${left},top=\${top},resizable=no`
	);
	
	// ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™
	//location.href=`\${mypath}/ext/webSocketMutiChatting.jsp`; // ì±„íŒ… ì „ìš© í˜ì´ì§€
}

	// HTMLì´ ë¡œë“œ ëœ í›„...
 	$(function() {
		//////////////// ë‹¤ë¥¸ í˜ì´ì§€ì—ë„ í•„ìˆ˜ë¡œ ë„£ì–´ì•¼ í•˜ëŠ” ì´ë²¤íŠ¸ //////////////////
	  	// ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ì‹œ...
	    $('#search-btn').on('click', function() {  
		  
	    	const stype = $('#stype').val();
			const sword = $('#sword').val().trim();
			$('#sword-result').text(sword || 'ì „ì²´');
			
			console.log(stype, sword);
		    
		    currentPage = 1;
		    console.log("ê²€ìƒ‰ë²„íŠ¼ í´ë¦­");
		    location.href = `<%=request.getContextPath()%>/bookSearch/bookSearchRes.jsp?stype=\${stype}&sword=\${sword}&sortType=popularity&currentPage=1`;
	 	});
	 	
	    $('#sword').on('keydown', function(e) {
			if(e.keyCode == 13 || e.which == 13) {
		        e.preventDefault(); // ê¸°ë³¸ ë™ì‘ ë°©ì§€
		        $('#search-btn').click();
		    }
		});
		////////////////////////////////////////////////////////////////////
	 
	 // ìŠ¬ë¼ì´ë” ì´ˆê¸°í™” (DOM ì¤€ë¹„ ì™„ë£Œ í›„)
		initializeSlider();


 	}) // $(function(){}) ë

</script>
</head>
  
<body>

    <!-- ìƒë‹¨ë°” -->
    <header class="header">
        <div class="header-content">
        	<div class="mypage-header">
        		<% if(mvo == null){ %>
                	<a href="<%= request.getContextPath() %>/log/login.jsp">ë¡œê·¸ì¸</a>
           		<%}else{ %>
           			<a href="javascript:void(0);" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</a>
           		<% } %>
           		<a href="#" onclick="goMypage()">ë§ˆì´í˜ì´ì§€</a>
        	</div>
        	<div class="top-header">

	            <!-- ê²€ìƒ‰ ì˜ì—­ -->
		        <section class="search-section">
		        	<div class="search-container">
		        	<!-- <div class="logo">ğŸ“š ë¶ë‹´</div> -->
		        	<a href="<%= request.getContextPath() %>/BestBook.do" class="logo">
					  <img src="<%= request.getContextPath() %>/images/logo/ì•„.png" alt="BookDam ë¡œê³ ">
					</a>
			            <form class="search-form">
			                <select class="search-category" id="stype">
			                    <option value="all">ì „ì²´</option>
			                    <option value="title">ë„ì„œëª…</option>
			                    <option value="author">ì €ì</option>
			                    <option value="publisher">ì¶œíŒì‚¬</option>
			                </select>
			                <input type="text" class="search-input" id="sword"
			                       placeholder="ê²€ìƒ‰í•  ë„ì„œëª… ë˜ëŠ” ì €ì ë˜ëŠ” ì¶œíŒì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
			                <button id="search-btn" type="button" class="search-btn">ğŸ”</button>
			             </form>
		             
			             <!-- í—¤ë” ì•„ì´ì½˜ë“¤ -->
			             <div class="header-icons">
			                <button onclick="location.href= mypath + '/attendance/attendance.jsp'" class="icon-btn" title="ì¶œì„ì²´í¬">ğŸ“†</button>
			              	<!--<button class="icon-btn" title="ì¥ë°”êµ¬ë‹ˆ">ğŸ›’</button>-->
			                <button onclick="location.href= mypath + '/cart/cart_page.jsp'" class="icon-btn" title="ì¥ë°”êµ¬ë‹ˆ" >ğŸ›’</button>
			             </div>
		             </div>
		        </section> 
        	</div>
        	
        </div>
    </header>
    
    <!-- í—¤ë” ì˜ì—­ -->
    <div class="header-container-ham">
    	
       	<!-- ë„¤ë¹„ê²Œì´ì…˜ ë©”ë‰´ -->
           <nav class="nav-menu">
           		<!-- í–„ë²„ê±° ë©”ë‰´ ë²„íŠ¼ -->
		        <button class="hamburger-btn" onclick="openCategoryMenu()">
		            <div class="hamburger-icon">
		                <span></span>
		                <span></span>
		                <span></span>
		            </div>
		        </button>
               <a href= '<%=request.getContextPath() %>/main/map.jsp'>ì„œì ì´ìš©ì•ˆë‚´</a>
               <a href= '<%=request.getContextPath() %>/bookSearch/bookBestseller.jsp'>ë² ìŠ¤íŠ¸ì…€ëŸ¬</a>
               <a href= '<%=request.getContextPath() %>/EventList.do'>ë¬¸í™”/í–‰ì‚¬</a>
               <a href= '<%=request.getContextPath() %>/NoticeList.do'>ê³µì§€ì‚¬í•­</a>
               <a href= '<%=request.getContextPath() %>/QnaList.do'>ê³ ê°ì„¼í„°</a> 
           </nav>
      </div>   
    <hr id="nav-bottom">

    <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
     <div class="main-container"> 
     	
     	<div class="new-slider-container">
        <div class="new-slider-wrapper" id="newSliderWrapper">
            <!-- ìŠ¬ë¼ì´ë“œ 1 -->
            <div class="new-slide" data-link="<%=request.getContextPath()%>/BookDetail.do?bookNo=9788936434120">
                <img src="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ1.png" alt="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ1.png">
                <div class="new-slide-overlay">
                </div>
            </div>
            
            <!-- ìŠ¬ë¼ì´ë“œ 2 -->
            <div class="new-slide" data-link="<%=request.getContextPath()%>/BookDetail.do?bookNo=9788952240569">
                <img src="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ2.png" alt="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ2.png">
                <div class="new-slide-overlay">
                </div>
            </div>
            
            <!-- ìŠ¬ë¼ì´ë“œ 3 -->
            <div class="new-slide" data-link="<%=request.getContextPath()%>/attendance/attendance.jsp">
                <img src="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ3.png" alt="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ3.png">
                <div class="new-slide-overlay">
                </div>
            </div>
            
            <!-- ìŠ¬ë¼ì´ë“œ 4 --> <!-- ì±„íŒ… í•˜ë©´ ì—°ê²°í•´ì•¼ í•©ë‹ˆë‹¤!!!! ìŠ¤í¬ë¦½íŠ¸ë„ ìˆ˜ì • -->
            <!-- <div class="new-slide" data-link="#category"> -->
            
            <div class="new-slide" onclick="connectWebSocket()">
            <!-- <div class="new-slide" data-link="http://192.168.146.75/chatExam/ext/webSocketMutiChatting.jsp"> -->
            <%-- <div class="new-slide" data-link="<%=request.getContextPath()%>/ext/webSocketMutiChatting.jsp">
            <div class="new-slide" data-link="http://192.168.146.75/chatExam/ext/webSocketMutiChatting.jsp">
            <div class="new-slide" data-link="<%=request.getContextPath()%>/ext/webSocketMutiChatting.jsp"> --%>
                <img src="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ4.png" alt="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ4.png">
                <div class="new-slide-overlay">
                </div>
            </div>
            
            <!-- ìŠ¬ë¼ì´ë“œ 5 -->
            <div class="new-slide" data-link="<%=request.getContextPath()%>/BookDetail.do?bookNo=9791193080146">
                <img src="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ5.png" alt="<%=request.getContextPath()%>/images/í™ˆë°°ë„ˆ5.png">
                <div class="new-slide-overlay">
                </div>
            </div>
        </div>
        
        <!-- ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ -->
        <button class="new-slider-nav new-prev-btn" onclick="newChangeSlide(-1)">â€¹</button>
        <button class="new-slider-nav new-next-btn" onclick="newChangeSlide(1)">â€º</button>
        
        <!-- ì¸ë””ì¼€ì´í„° -->
        <div class="new-slider-indicators">
		    <span class="new-indicator active" data-slide="0"></span>
		    <span class="new-indicator" data-slide="1"></span>
		    <span class="new-indicator" data-slide="2"></span>
		    <span class="new-indicator" data-slide="3"></span>
		    <span class="new-indicator" data-slide="4"></span>
		</div>
    </div>
		
		<!-- ğŸ”¥ ë² ìŠ¤íŠ¸ì…€ëŸ¬ -->
		<section class="book-section">
		  <div style="display: flex; justify-content: space-between; align-items: center;">
		    <h2 class="section-title">ğŸ”¥ ë² ìŠ¤íŠ¸ì…€ëŸ¬</h2>
		    <a href="<%=request.getContextPath()%>/bookSearch/bookBestseller.jsp" class="btn-more" 
		    style="background-color: #F85A44; color: white; padding: 6px 12px; border-radius: 5px; text-decoration: none;">ë”ë³´ê¸°</a>
		  </div>
		  
		  <div class="book-grid">
		    <c:forEach var="i" begin="0" end="4">
		      <c:choose>
		        <c:when test="${i < fn:length(bestList)}">
		          <c:set var="book" value="${bestList[i]}" />
		          <div class="book-card" onclick="goToBookDetail('${book.bookNo}')">
		            <img src="${book.coverImg}" alt="${book.bookTitle}" />
		            <div class="title">${book.bookTitle}</div>
		            <%-- <div class="price">â‚©${book.bookPrice}</div> --%>
		            <div class="price">â‚©<fmt:formatNumber value="${book.bookPrice}" type="number"/></div>
		          </div>
		        </c:when>
		        <c:otherwise>
		          <div class="book-card empty"></div>
		        </c:otherwise>
		      </c:choose>
		    </c:forEach>
		  </div>
		</section>
		
		<!-- ğŸ“š 20ëŒ€ ì¸ê¸°ë„ì„œ -->
		<section class="book-section">
		  <h2>ğŸ“š 20ëŒ€ ì¸ê¸°ë„ì„œ</h2>
		  <div class="book-grid" >
		    <c:forEach var="i" begin="0" end="4">
		      <c:choose>
		        <c:when test="${i < fn:length(ageList)}">
		          <c:set var="book" value="${ageList[i]}" />
		          <div class="book-card" onclick="goToBookDetail(${book.bookNo})">
		            <img src="${book.coverImg}" alt="${book.bookTitle}" />
		            <div class="title">${book.bookTitle}</div>
		            <%-- <div class="price">â‚©${book.bookPrice}</div> --%>
		            <div class="price">â‚©<fmt:formatNumber value="${book.bookPrice}" type="number"/></div>
		          </div>
		        </c:when>
		        <c:otherwise>
		          <div class="book-card empty"></div>
		        </c:otherwise>
		      </c:choose>
		    </c:forEach>
		  </div>
		</section>
		
		<!-- ğŸ“– ì¹´í…Œê³ ë¦¬ë³„ ì¸ê¸° ë„ì„œ -->
		<section class="book-section">
		  <h2>ğŸ“– ${topCategory} ì¸ê¸° ë„ì„œ</h2>
		  <div class="book-grid">
		    <c:forEach var="i" begin="0" end="4">
		      <c:choose>
		        <c:when test="${i < fn:length(categoryList)}">
		          <c:set var="book" value="${categoryList[i]}" />
		          <div class="book-card" onclick="goToBookDetail('${book.bookNo}')">
		            <img src="${book.coverImg}" alt="${book.bookTitle}" />
		            <div class="title">${book.bookTitle}</div>
		            <%-- <div class="price">â‚©${book.bookPrice}</div> --%>
		            <div class="price">â‚©<fmt:formatNumber value="${book.bookPrice}" type="number" /></div>
		          </div>
		        </c:when>
		        <c:otherwise>
		          <div class="book-card empty"></div>
		        </c:otherwise>
		      </c:choose>
		    </c:forEach>
		  </div>
		</section>
	</div>
	
	<!-- ì „ì²´í™”ë©´ ì¹´í…Œê³ ë¦¬ ì˜¤ë²„ë ˆì´ -->
    <div class="category-overlay" id="categoryOverlay" onclick="closeCategoryMenu()">
        <div class="category-popup" onclick="event.stopPropagation()">
            <!-- íŒì—… í—¤ë” -->
            <div class="popup-header">
                <div class="popup-title">ì¹´í…Œê³ ë¦¬ ì „ì²´ë³´ê¸°</div>
                <button class="close-btn" onclick="closeCategoryMenu()">Ã—</button>
            </div>
            <!-- ì¹´í…Œê³ ë¦¬ ì»¨í…ì¸  -->
            <div class="category-content">
                <div class="category-grid">

                        <!-- êµ­ë‚´ë„ì„œ -->
                        <div class="sub-category-section active" id="novel">
                            <div class="sub-category-title"></div>
                            <div class="sub-category-grid">
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì†Œì„¤')">ì†Œì„¤</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì—ì„¸ì´')">ì—ì„¸ì´</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì¸ë¬¸í•™')">ì¸ë¬¸í•™</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì‚¬íšŒê³¼í•™')">ì‚¬íšŒê³¼í•™</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ê³¼í•™')">ê³¼í•™</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ìê¸°ê³„ë°œ')">ìê¸°ê³„ë°œ</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ê²½ì œê²½ì˜')">ê²½ì œê²½ì˜</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ë§Œí™”')">ë§Œí™”</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì–´ë¦°ì´')">ì–´ë¦°ì´</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ìœ ì•„')">ìœ ì•„</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì¢…êµ')">ì¢…êµ</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì—­ì‚¬')">ì—­ì‚¬</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì˜ˆìˆ ')">ì˜ˆìˆ </a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì²­ì†Œë…„')">ì²­ì†Œë…„</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ìš”ë¦¬')">ìš”ë¦¬</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì¢‹ì€ë¶€ëª¨')">ì¢‹ì€ë¶€ëª¨</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì¡ì§€')">ì¡ì§€</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ê±´ê°•')">ê±´ê°•</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì„±ê³µ')">ì„±ê³µ</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì»´í“¨í„°')">ì»´í“¨í„°</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ìˆ˜í—˜ì„œ')">ìˆ˜í—˜ì„œ</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ì¤‘í•™êµì°¸ê³ ì„œ')">ì¤‘í•™êµì°¸ê³ ì„œ</a>
                                <a href="#" class="sub-category-item" onclick="goToBookList('ëŒ€í•™êµì¬')">ëŒ€í•™êµì¬</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

 	<!-- âœ… í‘¸í„° -->
	<footer>
	  <div>
		  ëŒ€ì „ê´‘ì—­ì‹œ ì¤‘êµ¬ ê³„ë£¡ë¡œ 846, 3-4ì¸µ 406í˜¸ (ìš°)34035 <br>
		  ë„ì„œ ë°ì´í„° ì œê³µ: ì•Œë¼ë”˜ API & ë„ì„œê´€ ì •ë³´ë‚˜ë£¨ <br>
		  &copy; 2025 BookDam. All rights reserved.
	  </div>
	</footer>    
</body>
</html>